file:
- statement:
  - statement:
    - merge_statement:
      - keyword: merge
      - table_reference:
        - object_reference:
          - naked_identifier: schema1
          - dot: .
          - naked_identifier: table1
      - alias_expression:
        - naked_identifier: dst
      - keyword: using
      - table_reference:
        - object_reference:
          - naked_identifier: schema1
          - dot: .
          - naked_identifier: table1
      - alias_expression:
        - naked_identifier: src
      - join_on_condition:
        - keyword: on
        - expression:
          - column_reference:
            - naked_identifier: src
            - dot: .
            - naked_identifier: rn
          - comparison_operator:
            - raw_comparison_operator: =
          - numeric_literal: '1'
          - binary_operator: and
          - column_reference:
            - naked_identifier: dst
            - dot: .
            - naked_identifier: e_date_to
          - keyword: is
          - null_literal: 'null'
          - binary_operator: and
          - column_reference:
            - naked_identifier: dst
            - dot: .
            - naked_identifier: cc_id
          - comparison_operator:
            - raw_comparison_operator: =
          - column_reference:
            - naked_identifier: src
            - dot: .
            - naked_identifier: cc_id
      - merge_match:
        - merge_when_matched_clause:
          - keyword: when
          - keyword: matched
          - keyword: then
          - merge_update_clause:
            - keyword: update
            - set_clause_list:
              - keyword: set
              - set_clause:
                - set_clause:
                  - column_reference:
                    - naked_identifier: dst
                    - dot: .
                    - naked_identifier: l_id
                  - assignment_operator:
                    - raw_comparison_operator: =
                  - expression:
                    - column_reference:
                      - naked_identifier: src
                      - dot: .
                      - naked_identifier: l_id
              - comma: ','
              - set_clause:
                - set_clause:
                  - column_reference:
                    - naked_identifier: dst
                    - dot: .
                    - naked_identifier: e_date_to
                  - assignment_operator:
                    - raw_comparison_operator: =
                  - expression:
                    - column_reference:
                      - naked_identifier: src
                      - dot: .
                      - naked_identifier: e_date_from
  - keyword: go
  - statement:
    - with_compound_statement:
      - keyword: with
      - common_table_expression:
        - naked_identifier: source_data
        - keyword: as
        - bracketed:
          - start_bracket: (
          - select_statement:
            - select_clause:
              - keyword: select
              - select_clause_element:
                - column_reference:
                  - naked_identifier: cc_id
              - comma: ','
              - select_clause_element:
                - column_reference:
                  - naked_identifier: cc_name
              - comma: ','
              - select_clause_element:
                - column_reference:
                  - naked_identifier: cc_description
            - from_clause:
              - keyword: from
              - from_expression:
                - from_expression_element:
                  - from_expression_element:
                    - table_expression:
                      - table_reference:
                        - object_reference:
                          - naked_identifier: DW
                          - dot: .
                          - naked_identifier: sch1
                          - dot: .
                          - naked_identifier: tbl1
            - where_clause:
              - keyword: where
              - expression:
                - column_reference:
                  - naked_identifier: e_date_to
                - keyword: is
                - null_literal: 'null'
                - binary_operator: and
                - column_reference:
                  - naked_identifier: l_id
                - comparison_operator:
                  - raw_comparison_operator: '>'
                  - raw_comparison_operator: =
                - column_reference:
                  - naked_identifier: dd
                - binary_operator: and
                - column_reference:
                  - naked_identifier: l_id
                - comparison_operator:
                  - raw_comparison_operator: <
                  - raw_comparison_operator: =
                - column_reference:
                  - naked_identifier: dd
          - end_bracket: )
      - merge_statement:
        - keyword: merge
        - table_reference:
          - object_reference:
            - naked_identifier: DM
            - dot: .
            - naked_identifier: sch1
            - dot: .
            - naked_identifier: tbl2
        - alias_expression:
          - naked_identifier: dst
        - keyword: using
        - table_reference:
          - object_reference:
            - naked_identifier: source_data
        - alias_expression:
          - naked_identifier: src
        - join_on_condition:
          - keyword: on
          - expression:
            - column_reference:
              - naked_identifier: src
              - dot: .
              - naked_identifier: cc_id
            - comparison_operator:
              - raw_comparison_operator: =
            - column_reference:
              - naked_identifier: dst
              - dot: .
              - naked_identifier: cc_id
        - merge_match:
          - merge_when_matched_clause:
            - keyword: when
            - keyword: matched
            - keyword: then
            - merge_update_clause:
              - keyword: update
              - set_clause_list:
                - keyword: set
                - set_clause:
                  - set_clause:
                    - column_reference:
                      - naked_identifier: dst
                      - dot: .
                      - naked_identifier: cc_name
                    - assignment_operator:
                      - raw_comparison_operator: =
                    - expression:
                      - column_reference:
                        - naked_identifier: src
                        - dot: .
                        - naked_identifier: cc_name
                - comma: ','
                - set_clause:
                  - set_clause:
                    - column_reference:
                      - naked_identifier: dst
                      - dot: .
                      - naked_identifier: cc_description
                    - assignment_operator:
                      - raw_comparison_operator: =
                    - expression:
                      - column_reference:
                        - naked_identifier: src
                        - dot: .
                        - naked_identifier: cc_description
          - merge_when_not_matched_clause:
            - merge_when_not_matched_clause:
              - keyword: when
              - keyword: not
              - keyword: matched
              - keyword: then
              - merge_insert_clause:
                - keyword: insert
                - bracketed:
                  - start_bracket: (
                  - column_reference:
                    - naked_identifier: cc_id
                  - comma: ','
                  - column_reference:
                    - naked_identifier: cc_name
                  - comma: ','
                  - column_reference:
                    - naked_identifier: cc_description
                  - end_bracket: )
                - values_clause:
                  - keyword: values
                  - bracketed:
                    - start_bracket: (
                    - expression:
                      - column_reference:
                        - naked_identifier: cc_id
                    - comma: ','
                    - expression:
                      - column_reference:
                        - naked_identifier: cc_name
                    - comma: ','
                    - expression:
                      - column_reference:
                        - naked_identifier: cc_description
                    - end_bracket: )
  - statement_terminator: ;
  - keyword: go
  - statement:
    - merge_statement:
      - keyword: merge
      - table_reference:
        - object_reference:
          - naked_identifier: DW
          - dot: .
          - naked_identifier: tt
          - dot: .
          - naked_identifier: dd
      - alias_expression:
        - naked_identifier: dst
      - keyword: using
      - table_reference:
        - object_reference:
          - naked_identifier: LA
          - dot: .
          - naked_identifier: tt
          - dot: .
          - naked_identifier: dd
      - alias_expression:
        - naked_identifier: src
      - join_on_condition:
        - keyword: on
        - expression:
          - column_reference:
            - naked_identifier: dst
            - dot: .
            - naked_identifier: s_id
          - comparison_operator:
            - raw_comparison_operator: =
          - column_reference:
            - naked_identifier: src
            - dot: .
            - naked_identifier: s_id
          - binary_operator: and
          - column_reference:
            - naked_identifier: dst
            - dot: .
            - naked_identifier: c_id
          - comparison_operator:
            - raw_comparison_operator: =
          - column_reference:
            - naked_identifier: src
            - dot: .
            - naked_identifier: c_id
      - merge_match:
        - merge_when_matched_clause:
          - keyword: when
          - keyword: matched
          - keyword: then
          - merge_update_clause:
            - keyword: update
            - set_clause_list:
              - keyword: set
              - set_clause:
                - set_clause:
                  - column_reference:
                    - naked_identifier: dst
                    - dot: .
                    - naked_identifier: c_name
                  - assignment_operator:
                    - raw_comparison_operator: =
                  - expression:
                    - column_reference:
                      - naked_identifier: src
                      - dot: .
                      - naked_identifier: c_name
              - comma: ','
              - set_clause:
                - set_clause:
                  - column_reference:
                    - naked_identifier: dst
                    - dot: .
                    - naked_identifier: col1
                  - assignment_operator:
                    - raw_comparison_operator: =
                  - expression:
                    - column_reference:
                      - naked_identifier: src
                      - dot: .
                      - naked_identifier: col1
              - comma: ','
              - set_clause:
                - set_clause:
                  - column_reference:
                    - naked_identifier: dst
                    - dot: .
                    - naked_identifier: col2
                  - assignment_operator:
                    - raw_comparison_operator: =
                  - expression:
                    - column_reference:
                      - naked_identifier: src
                      - dot: .
                      - naked_identifier: col2
        - merge_when_not_matched_clause:
          - merge_when_not_matched_clause:
            - keyword: when
            - keyword: not
            - keyword: matched
            - keyword: by
            - keyword: target
            - keyword: and
            - expression:
              - column_reference:
                - naked_identifier: src
                - dot: .
                - naked_identifier: c_id
              - keyword: is
              - keyword: not
              - null_literal: 'null'
            - keyword: then
            - merge_insert_clause:
              - keyword: insert
              - bracketed:
                - start_bracket: (
                - column_reference:
                  - naked_identifier: s_id
                - comma: ','
                - column_reference:
                  - naked_identifier: c_id
                - comma: ','
                - column_reference:
                  - naked_identifier: c_name
                - comma: ','
                - column_reference:
                  - naked_identifier: col1
                - comma: ','
                - column_reference:
                  - naked_identifier: col2
                - end_bracket: )
              - values_clause:
                - keyword: values
                - bracketed:
                  - start_bracket: (
                  - expression:
                    - column_reference:
                      - naked_identifier: src
                      - dot: .
                      - naked_identifier: s_id
                  - comma: ','
                  - expression:
                    - column_reference:
                      - naked_identifier: src
                      - dot: .
                      - naked_identifier: c_id
                  - comma: ','
                  - expression:
                    - column_reference:
                      - naked_identifier: src
                      - dot: .
                      - naked_identifier: c_name
                  - comma: ','
                  - expression:
                    - column_reference:
                      - naked_identifier: src
                      - dot: .
                      - naked_identifier: col1
                  - comma: ','
                  - expression:
                    - column_reference:
                      - naked_identifier: src
                      - dot: .
                      - naked_identifier: col2
                  - end_bracket: )
- unparsable:
  - word: when
  - word: not
  - word: matched
  - word: by
  - word: source
  - word: and
  - word: s_id
  - raw_comparison_operator: =
  - numeric_literal: '1'
  - word: in
  - start_bracket: (
  - word: select
  - word: s_id
  - word: from
  - word: LA
  - dot: .
  - word: g
  - dot: .
  - word: tbl3
  - end_bracket: )
  - word: then
  - word: update
  - word: set
  - word: dst
  - dot: .
  - word: col1
  - raw_comparison_operator: =
  - single_quote: '''N'''
  - comma: ','
  - word: dst
  - dot: .
  - word: col2
  - raw_comparison_operator: =
  - word: col2
  - semicolon: ;
  - word: go
  - word: MERGE
  - word: Production
  - dot: .
  - word: UnitMeasure
  - word: AS
  - word: tgt
  - word: USING
  - start_bracket: (
  - word: SELECT
  - tsql_variable: '@UnitMeasureCode'
  - comma: ','
  - tsql_variable: '@Name'
  - end_bracket: )
  - word: as
  - word: src
  - start_bracket: (
  - word: UnitMeasureCode
  - comma: ','
  - word: Name
  - end_bracket: )
  - word: ON
  - start_bracket: (
  - word: tgt
  - dot: .
  - word: UnitMeasureCode
  - raw_comparison_operator: =
  - word: src
  - dot: .
  - word: UnitMeasureCode
  - end_bracket: )
  - word: WHEN
  - word: MATCHED
  - word: THEN
  - word: UPDATE
  - word: SET
  - word: Name
  - raw_comparison_operator: =
  - word: src
  - dot: .
  - word: Name
  - word: WHEN
  - word: NOT
  - word: MATCHED
  - word: THEN
  - word: INSERT
  - start_bracket: (
  - word: UnitMeasureCode
  - comma: ','
  - word: Name
  - end_bracket: )
  - word: VALUES
  - start_bracket: (
  - word: src
  - dot: .
  - word: UnitMeasureCode
  - comma: ','
  - word: src
  - dot: .
  - word: Name
  - end_bracket: )
  - word: OUTPUT
  - word: deleted
  - dot: .
  - star: '*'
  - comma: ','
