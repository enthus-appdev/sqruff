file:
- statement:
  - statement:
    - merge_statement:
      - keyword: merge
      - table_reference:
        - object_reference:
          - naked_identifier: schema1
          - dot: .
          - naked_identifier: table1
      - alias_expression:
        - naked_identifier: dst
      - keyword: using
      - table_reference:
        - object_reference:
          - naked_identifier: schema1
          - dot: .
          - naked_identifier: table1
      - alias_expression:
        - naked_identifier: src
      - join_on_condition:
        - keyword: on
        - expression:
          - column_reference:
            - naked_identifier: src
            - dot: .
            - naked_identifier: rn
          - comparison_operator:
            - raw_comparison_operator: =
          - numeric_literal: '1'
          - binary_operator: and
          - column_reference:
            - naked_identifier: dst
            - dot: .
            - naked_identifier: e_date_to
          - keyword: is
          - null_literal: 'null'
          - binary_operator: and
          - column_reference:
            - naked_identifier: dst
            - dot: .
            - naked_identifier: cc_id
          - comparison_operator:
            - raw_comparison_operator: =
          - column_reference:
            - naked_identifier: src
            - dot: .
            - naked_identifier: cc_id
      - merge_match:
        - merge_match:
          - merge_when_matched_clause:
            - keyword: when
            - keyword: matched
            - keyword: then
            - merge_update_clause:
              - keyword: update
              - set_clause_list:
                - keyword: set
                - set_clause:
                  - set_clause:
                    - column_reference:
                      - naked_identifier: dst
                      - dot: .
                      - naked_identifier: l_id
                    - assignment_operator:
                      - raw_comparison_operator: =
                    - expression:
                      - column_reference:
                        - naked_identifier: src
                        - dot: .
                        - naked_identifier: l_id
                - comma: ','
                - set_clause:
                  - set_clause:
                    - column_reference:
                      - naked_identifier: dst
                      - dot: .
                      - naked_identifier: e_date_to
                    - assignment_operator:
                      - raw_comparison_operator: =
                    - expression:
                      - column_reference:
                        - naked_identifier: src
                        - dot: .
                        - naked_identifier: e_date_from
  - keyword: go
  - statement:
    - with_compound_statement:
      - keyword: with
      - common_table_expression:
        - naked_identifier: source_data
        - keyword: as
        - bracketed:
          - start_bracket: (
          - select_statement:
            - select_clause:
              - keyword: select
              - select_clause_element:
                - column_reference:
                  - naked_identifier: cc_id
              - comma: ','
              - select_clause_element:
                - column_reference:
                  - naked_identifier: cc_name
              - comma: ','
              - select_clause_element:
                - column_reference:
                  - naked_identifier: cc_description
            - from_clause:
              - keyword: from
              - from_expression:
                - from_expression:
                  - from_expression_element:
                    - from_expression_element:
                      - table_expression:
                        - table_reference:
                          - object_reference:
                            - naked_identifier: DW
                            - dot: .
                            - naked_identifier: sch1
                            - dot: .
                            - naked_identifier: tbl1
            - where_clause:
              - keyword: where
              - expression:
                - column_reference:
                  - naked_identifier: e_date_to
                - keyword: is
                - null_literal: 'null'
                - binary_operator: and
                - column_reference:
                  - naked_identifier: l_id
                - comparison_operator:
                  - raw_comparison_operator: '>'
                  - raw_comparison_operator: =
                - column_reference:
                  - naked_identifier: dd
                - binary_operator: and
                - column_reference:
                  - naked_identifier: l_id
                - comparison_operator:
                  - raw_comparison_operator: <
                  - raw_comparison_operator: =
                - column_reference:
                  - naked_identifier: dd
          - end_bracket: )
      - merge_statement:
        - keyword: merge
        - table_reference:
          - object_reference:
            - naked_identifier: DM
            - dot: .
            - naked_identifier: sch1
            - dot: .
            - naked_identifier: tbl2
        - alias_expression:
          - naked_identifier: dst
        - keyword: using
        - table_reference:
          - object_reference:
            - naked_identifier: source_data
        - alias_expression:
          - naked_identifier: src
        - join_on_condition:
          - keyword: on
          - expression:
            - column_reference:
              - naked_identifier: src
              - dot: .
              - naked_identifier: cc_id
            - comparison_operator:
              - raw_comparison_operator: =
            - column_reference:
              - naked_identifier: dst
              - dot: .
              - naked_identifier: cc_id
        - merge_match:
          - merge_match:
            - merge_when_matched_clause:
              - keyword: when
              - keyword: matched
              - keyword: then
              - merge_update_clause:
                - keyword: update
                - set_clause_list:
                  - keyword: set
                  - set_clause:
                    - set_clause:
                      - column_reference:
                        - naked_identifier: dst
                        - dot: .
                        - naked_identifier: cc_name
                      - assignment_operator:
                        - raw_comparison_operator: =
                      - expression:
                        - column_reference:
                          - naked_identifier: src
                          - dot: .
                          - naked_identifier: cc_name
                  - comma: ','
                  - set_clause:
                    - set_clause:
                      - column_reference:
                        - naked_identifier: dst
                        - dot: .
                        - naked_identifier: cc_description
                      - assignment_operator:
                        - raw_comparison_operator: =
                      - expression:
                        - column_reference:
                          - naked_identifier: src
                          - dot: .
                          - naked_identifier: cc_description
            - merge_when_not_matched_clause:
              - merge_when_not_matched_clause:
                - keyword: when
                - keyword: not
                - keyword: matched
                - keyword: then
                - merge_insert_clause:
                  - keyword: insert
                  - bracketed:
                    - start_bracket: (
                    - column_reference:
                      - naked_identifier: cc_id
                    - comma: ','
                    - column_reference:
                      - naked_identifier: cc_name
                    - comma: ','
                    - column_reference:
                      - naked_identifier: cc_description
                    - end_bracket: )
                  - values_clause:
                    - keyword: values
                    - bracketed:
                      - start_bracket: (
                      - expression:
                        - column_reference:
                          - naked_identifier: cc_id
                      - comma: ','
                      - expression:
                        - column_reference:
                          - naked_identifier: cc_name
                      - comma: ','
                      - expression:
                        - column_reference:
                          - naked_identifier: cc_description
                      - end_bracket: )
  - statement_terminator: ;
  - keyword: go
  - statement:
    - merge_statement:
      - keyword: merge
      - table_reference:
        - object_reference:
          - naked_identifier: DW
          - dot: .
          - naked_identifier: tt
          - dot: .
          - naked_identifier: dd
      - alias_expression:
        - naked_identifier: dst
      - keyword: using
      - table_reference:
        - object_reference:
          - naked_identifier: LA
          - dot: .
          - naked_identifier: tt
          - dot: .
          - naked_identifier: dd
      - alias_expression:
        - naked_identifier: src
      - join_on_condition:
        - keyword: on
        - expression:
          - column_reference:
            - naked_identifier: dst
            - dot: .
            - naked_identifier: s_id
          - comparison_operator:
            - raw_comparison_operator: =
          - column_reference:
            - naked_identifier: src
            - dot: .
            - naked_identifier: s_id
          - binary_operator: and
          - column_reference:
            - naked_identifier: dst
            - dot: .
            - naked_identifier: c_id
          - comparison_operator:
            - raw_comparison_operator: =
          - column_reference:
            - naked_identifier: src
            - dot: .
            - naked_identifier: c_id
      - merge_match:
        - merge_match:
          - merge_when_matched_clause:
            - keyword: when
            - keyword: matched
            - keyword: then
            - merge_update_clause:
              - keyword: update
              - set_clause_list:
                - keyword: set
                - set_clause:
                  - set_clause:
                    - column_reference:
                      - naked_identifier: dst
                      - dot: .
                      - naked_identifier: c_name
                    - assignment_operator:
                      - raw_comparison_operator: =
                    - expression:
                      - column_reference:
                        - naked_identifier: src
                        - dot: .
                        - naked_identifier: c_name
                - comma: ','
                - set_clause:
                  - set_clause:
                    - column_reference:
                      - naked_identifier: dst
                      - dot: .
                      - naked_identifier: col1
                    - assignment_operator:
                      - raw_comparison_operator: =
                    - expression:
                      - column_reference:
                        - naked_identifier: src
                        - dot: .
                        - naked_identifier: col1
                - comma: ','
                - set_clause:
                  - set_clause:
                    - column_reference:
                      - naked_identifier: dst
                      - dot: .
                      - naked_identifier: col2
                    - assignment_operator:
                      - raw_comparison_operator: =
                    - expression:
                      - column_reference:
                        - naked_identifier: src
                        - dot: .
                        - naked_identifier: col2
          - merge_when_not_matched_clause:
            - merge_when_not_matched_clause:
              - keyword: when
              - keyword: not
              - keyword: matched
              - keyword: by
              - keyword: target
              - keyword: and
              - expression:
                - column_reference:
                  - naked_identifier: src
                  - dot: .
                  - naked_identifier: c_id
                - keyword: is
                - keyword: not
                - null_literal: 'null'
              - keyword: then
              - merge_insert_clause:
                - keyword: insert
                - bracketed:
                  - start_bracket: (
                  - column_reference:
                    - naked_identifier: s_id
                  - comma: ','
                  - column_reference:
                    - naked_identifier: c_id
                  - comma: ','
                  - column_reference:
                    - naked_identifier: c_name
                  - comma: ','
                  - column_reference:
                    - naked_identifier: col1
                  - comma: ','
                  - column_reference:
                    - naked_identifier: col2
                  - end_bracket: )
                - values_clause:
                  - keyword: values
                  - bracketed:
                    - start_bracket: (
                    - expression:
                      - column_reference:
                        - naked_identifier: src
                        - dot: .
                        - naked_identifier: s_id
                    - comma: ','
                    - expression:
                      - column_reference:
                        - naked_identifier: src
                        - dot: .
                        - naked_identifier: c_id
                    - comma: ','
                    - expression:
                      - column_reference:
                        - naked_identifier: src
                        - dot: .
                        - naked_identifier: c_name
                    - comma: ','
                    - expression:
                      - column_reference:
                        - naked_identifier: src
                        - dot: .
                        - naked_identifier: col1
                    - comma: ','
                    - expression:
                      - column_reference:
                        - naked_identifier: src
                        - dot: .
                        - naked_identifier: col2
                    - end_bracket: )
          - merge_when_not_matched_clause:
            - merge_when_not_matched_clause:
              - keyword: when
              - keyword: not
              - keyword: matched
              - keyword: by
              - keyword: source
              - keyword: and
              - expression:
                - column_reference:
                  - naked_identifier: s_id
                - comparison_operator:
                  - raw_comparison_operator: =
                - numeric_literal: '1'
                - keyword: in
                - bracketed:
                  - start_bracket: (
                  - select_statement:
                    - select_clause:
                      - keyword: select
                      - select_clause_element:
                        - column_reference:
                          - naked_identifier: s_id
                    - from_clause:
                      - keyword: from
                      - from_expression:
                        - from_expression:
                          - from_expression_element:
                            - from_expression_element:
                              - table_expression:
                                - table_reference:
                                  - object_reference:
                                    - naked_identifier: LA
                                    - dot: .
                                    - naked_identifier: g
                                    - dot: .
                                    - naked_identifier: tbl3
                  - end_bracket: )
              - keyword: then
              - merge_update_clause:
                - keyword: update
                - set_clause_list:
                  - keyword: set
                  - set_clause:
                    - set_clause:
                      - column_reference:
                        - naked_identifier: dst
                        - dot: .
                        - naked_identifier: col1
                      - assignment_operator:
                        - raw_comparison_operator: =
                      - expression:
                        - quoted_literal: '''N'''
                  - comma: ','
                  - set_clause:
                    - set_clause:
                      - column_reference:
                        - naked_identifier: dst
                        - dot: .
                        - naked_identifier: col2
                      - assignment_operator:
                        - raw_comparison_operator: =
                      - expression:
                        - column_reference:
                          - naked_identifier: col2
  - statement_terminator: ;
  - keyword: go
  - statement:
    - merge_statement:
      - keyword: MERGE
      - table_reference:
        - object_reference:
          - naked_identifier: Production
          - dot: .
          - naked_identifier: UnitMeasure
      - alias_expression:
        - keyword: AS
        - naked_identifier: tgt
      - keyword: USING
      - bracketed:
        - start_bracket: (
        - select_statement:
          - select_clause:
            - keyword: SELECT
            - select_clause_element:
              - parameterized_expression:
                - tsql_variable: '@UnitMeasureCode'
            - comma: ','
            - select_clause_element:
              - parameterized_expression:
                - tsql_variable: '@Name'
        - end_bracket: )
      - alias_expression:
        - keyword: as
        - naked_identifier: src
        - bracketed:
          - start_bracket: (
          - identifier_list:
            - naked_identifier: UnitMeasureCode
            - comma: ','
            - naked_identifier: Name
          - end_bracket: )
      - join_on_condition:
        - keyword: ON
        - bracketed:
          - start_bracket: (
          - expression:
            - column_reference:
              - naked_identifier: tgt
              - dot: .
              - naked_identifier: UnitMeasureCode
            - comparison_operator:
              - raw_comparison_operator: =
            - column_reference:
              - naked_identifier: src
              - dot: .
              - naked_identifier: UnitMeasureCode
          - end_bracket: )
      - merge_match:
        - merge_match:
          - merge_when_matched_clause:
            - keyword: WHEN
            - keyword: MATCHED
            - keyword: THEN
            - merge_update_clause:
              - keyword: UPDATE
              - set_clause_list:
                - keyword: SET
                - set_clause:
                  - set_clause:
                    - column_reference:
                      - naked_identifier: Name
                    - assignment_operator:
                      - raw_comparison_operator: =
                    - expression:
                      - column_reference:
                        - naked_identifier: src
                        - dot: .
                        - naked_identifier: Name
          - merge_when_not_matched_clause:
            - merge_when_not_matched_clause:
              - keyword: WHEN
              - keyword: NOT
              - keyword: MATCHED
              - keyword: THEN
              - merge_insert_clause:
                - keyword: INSERT
                - bracketed:
                  - start_bracket: (
                  - column_reference:
                    - naked_identifier: UnitMeasureCode
                  - comma: ','
                  - column_reference:
                    - naked_identifier: Name
                  - end_bracket: )
                - values_clause:
                  - keyword: VALUES
                  - bracketed:
                    - start_bracket: (
                    - expression:
                      - column_reference:
                        - naked_identifier: src
                        - dot: .
                        - naked_identifier: UnitMeasureCode
                    - comma: ','
                    - expression:
                      - column_reference:
                        - naked_identifier: src
                        - dot: .
                        - naked_identifier: Name
                    - end_bracket: )
  - statement:
    - object_reference:
      - naked_identifier: OUTPUT
- unparsable:
  - word: deleted
  - dot: .
  - star: '*'
  - comma: ','
