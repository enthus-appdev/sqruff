file:
- statement:
  - with_compound_statement:
    - keyword: WITH
    - common_table_expression:
      - naked_identifier: OrderDeliverydateCriticalCTE
      - keyword: AS
      - bracketed:
        - start_bracket: (
        - select_statement:
          - select_clause:
            - keyword: SELECT
            - select_clause_element:
              - expression:
                - column_reference:
                  - naked_identifier: OrderID
                - comparison_operator:
                  - raw_comparison_operator: =
                - column_reference:
                  - naked_identifier: Orders
                  - dot: .
                  - naked_identifier: I_ORDERS_P
            - comma: ','
            - select_clause_element:
              - expression:
                - column_reference:
                  - naked_identifier: CurrentState
                - comparison_operator:
                  - raw_comparison_operator: =
                - column_reference:
                  - naked_identifier: b_deliverydatecritical
            - comma: ','
            - select_clause_element:
              - expression:
                - column_reference:
                  - naked_identifier: CalculatedState
                - comparison_operator:
                  - raw_comparison_operator: =
                - bracketed:
                  - start_bracket: (
                  - expression:
                    - case_expression:
                      - keyword: CASE
                      - when_clause:
                        - keyword: WHEN
                        - expression:
                          - keyword: EXISTS
                          - bracketed:
                            - start_bracket: (
                            - select_statement:
                              - select_clause:
                                - keyword: SELECT
                                - select_clause_element:
                                  - numeric_literal: '1'
                              - from_clause:
                                - keyword: FROM
                                - from_expression:
                                  - from_expression_element:
                                    - table_expression:
                                      - table_reference:
                                        - table_reference:
                                          - object_reference:
                                            - naked_identifier: sao
                                            - dot: .
                                            - naked_identifier: ORDERPOS_P
                                    - alias_expression:
                                      - keyword: AS
                                      - naked_identifier: OrderPositions
                                    - keyword: WITH
                                    - bracketed:
                                      - start_bracket: (
                                      - keyword: READUNCOMMITTED
                                      - end_bracket: )
                                  - join_clause:
                                    - keyword: INNER
                                    - keyword: JOIN
                                    - from_expression_element:
                                      - table_expression:
                                        - table_reference:
                                          - table_reference:
                                            - object_reference:
                                              - naked_identifier: sao
                                              - dot: .
                                              - naked_identifier: NegSoft_ERP_SalesOrderPosition2PurchaseOrderPosition
                                      - alias_expression:
                                        - keyword: AS
                                        - naked_identifier: sop2pop
                                      - keyword: WITH
                                      - bracketed:
                                        - start_bracket: (
                                        - keyword: READUNCOMMITTED
                                        - end_bracket: )
                                    - join_on_condition:
                                      - keyword: ON
                                      - expression:
                                        - column_reference:
                                          - naked_identifier: sop2pop
                                          - dot: .
                                          - naked_identifier: i_orderpos_id
                                        - comparison_operator:
                                          - raw_comparison_operator: =
                                        - column_reference:
                                          - naked_identifier: OrderPositions
                                          - dot: .
                                          - naked_identifier: I_ORDERPOS_P
                                        - binary_operator: AND
                                        - column_reference:
                                          - naked_identifier: sop2pop
                                          - dot: .
                                          - naked_identifier: dt_deleted
                                        - keyword: IS
                                        - null_literal: 'NULL'
                              - where_clause:
                                - keyword: WHERE
                                - expression:
                                  - column_reference:
                                    - naked_identifier: OrderPositions
                                    - dot: .
                                    - naked_identifier: I_ORDERS_P
                                  - comparison_operator:
                                    - raw_comparison_operator: =
                                  - column_reference:
                                    - naked_identifier: Orders
                                    - dot: .
                                    - naked_identifier: I_ORDERS_P
                                  - binary_operator: AND
                                  - column_reference:
                                    - naked_identifier: OrderPositions
                                    - dot: .
                                    - naked_identifier: DT_DELETED
                                  - keyword: IS
                                  - null_literal: 'NULL'
                                  - binary_operator: AND
                                  - column_reference:
                                    - naked_identifier: NxOrder
                                    - dot: .
                                    - naked_identifier: i_deliverydatetype_id
                                  - keyword: IN
                                  - bracketed:
                                    - start_bracket: (
                                    - numeric_literal: '1'
                                    - comma: ','
                                    - numeric_literal: '2'
                                    - end_bracket: )
                                  - binary_operator: AND
                                  - function:
                                    - function_name:
                                      - function_name_identifier: DATEDIFF
                                    - bracketed:
                                      - start_bracket: (
                                      - date_part: DAY
                                      - comma: ','
                                      - expression:
                                        - bracketed:
                                          - start_bracket: (
                                          - expression:
                                            - select_statement:
                                              - select_clause:
                                                - keyword: SELECT
                                                - select_clause_element:
                                                  - column_reference:
                                                    - naked_identifier: EndDate
                                              - from_clause:
                                                - keyword: FROM
                                                - from_expression:
                                                  - from_expression_element:
                                                    - table_expression:
                                                      - function:
                                                        - function_name:
                                                          - naked_identifier: sao
                                                          - dot: .
                                                          - function_name_identifier: negsoft_tblfct_calculateworkingdays
                                                        - bracketed:
                                                          - start_bracket: (
                                                          - expression:
                                                            - bracketed:
                                                              - start_bracket: (
                                                              - expression:
                                                                - select_statement:
                                                                  - select_clause:
                                                                    - keyword: SELECT
                                                                    - select_clause_element:
                                                                      - function:
                                                                        - function_name:
                                                                          - function_name_identifier: MAX
                                                                        - bracketed:
                                                                          - start_bracket: (
                                                                          - expression:
                                                                            - column_reference:
                                                                              - naked_identifier: sop2popPurOrdPos
                                                                              - dot: .
                                                                              - naked_identifier: D_DELIVERYDATE
                                                                          - end_bracket: )
                                                                  - from_clause:
                                                                    - keyword: FROM
                                                                    - from_expression:
                                                                      - from_expression_element:
                                                                        - table_expression:
                                                                          - table_reference:
                                                                            - table_reference:
                                                                              - object_reference:
                                                                                - naked_identifier: sao
                                                                                - dot: .
                                                                                - naked_identifier: NegSoft_ERP_SalesOrderPosition2PurchaseOrderPosition
                                                                        - alias_expression:
                                                                          - keyword: AS
                                                                          - naked_identifier: sop2pop
                                                                        - keyword: WITH
                                                                        - bracketed:
                                                                          - start_bracket: (
                                                                          - keyword: NOLOCK
                                                                          - end_bracket: )
                                                                      - join_clause:
                                                                        - keyword: INNER
                                                                        - keyword: JOIN
                                                                        - from_expression_element:
                                                                          - table_expression:
                                                                            - table_reference:
                                                                              - table_reference:
                                                                                - object_reference:
                                                                                  - naked_identifier: sao
                                                                                  - dot: .
                                                                                  - naked_identifier: ORDERPOS_P
                                                                          - alias_expression:
                                                                            - keyword: AS
                                                                            - naked_identifier: sop2popOrdPos
                                                                          - keyword: WITH
                                                                          - bracketed:
                                                                            - start_bracket: (
                                                                            - keyword: NOLOCK
                                                                            - end_bracket: )
                                                                        - join_on_condition:
                                                                          - keyword: ON
                                                                          - expression:
                                                                            - column_reference:
                                                                              - naked_identifier: sop2popOrdPos
                                                                              - dot: .
                                                                              - naked_identifier: I_ORDERPOS_P
                                                                            - comparison_operator:
                                                                              - raw_comparison_operator: =
                                                                            - column_reference:
                                                                              - naked_identifier: SOP2POP
                                                                              - dot: .
                                                                              - naked_identifier: i_orderpos_id
                                                                            - binary_operator: AND
                                                                            - column_reference:
                                                                              - naked_identifier: sop2popOrdPos
                                                                              - dot: .
                                                                              - naked_identifier: DT_DELETED
                                                                            - keyword: IS
                                                                            - null_literal: 'NULL'
                                                                      - join_clause:
                                                                        - keyword: INNER
                                                                        - keyword: JOIN
                                                                        - from_expression_element:
                                                                          - table_expression:
                                                                            - table_reference:
                                                                              - table_reference:
                                                                                - object_reference:
                                                                                  - naked_identifier: sao
                                                                                  - dot: .
                                                                                  - naked_identifier: ORDERS_P
                                                                          - alias_expression:
                                                                            - keyword: AS
                                                                            - naked_identifier: sop2popOrd
                                                                          - keyword: WITH
                                                                          - bracketed:
                                                                            - start_bracket: (
                                                                            - keyword: NOLOCK
                                                                            - end_bracket: )
                                                                        - join_on_condition:
                                                                          - keyword: ON
                                                                          - expression:
                                                                            - column_reference:
                                                                              - naked_identifier: sop2popOrd
                                                                              - dot: .
                                                                              - naked_identifier: I_ORDERS_P
                                                                            - comparison_operator:
                                                                              - raw_comparison_operator: =
                                                                            - column_reference:
                                                                              - naked_identifier: sop2popOrdPos
                                                                              - dot: .
                                                                              - naked_identifier: I_ORDERS_P
                                                                            - binary_operator: AND
                                                                            - column_reference:
                                                                              - naked_identifier: sop2popOrd
                                                                              - dot: .
                                                                              - naked_identifier: DT_DELETED
                                                                            - keyword: IS
                                                                            - null_literal: 'NULL'
                                                                      - join_clause:
                                                                        - keyword: INNER
                                                                        - keyword: JOIN
                                                                        - from_expression_element:
                                                                          - table_expression:
                                                                            - table_reference:
                                                                              - table_reference:
                                                                                - object_reference:
                                                                                  - naked_identifier: sao
                                                                                  - dot: .
                                                                                  - naked_identifier: PURORDPOS_P
                                                                          - alias_expression:
                                                                            - keyword: AS
                                                                            - naked_identifier: sop2popPurOrdPos
                                                                          - keyword: WITH
                                                                          - bracketed:
                                                                            - start_bracket: (
                                                                            - keyword: NOLOCK
                                                                            - end_bracket: )
                                                                        - join_on_condition:
                                                                          - keyword: ON
                                                                          - expression:
                                                                            - column_reference:
                                                                              - naked_identifier: sop2popPurOrdPos
                                                                              - dot: .
                                                                              - naked_identifier: I_PURORDPOS_P
                                                                            - comparison_operator:
                                                                              - raw_comparison_operator: =
                                                                            - column_reference:
                                                                              - naked_identifier: SOP2POP
                                                                              - dot: .
                                                                              - naked_identifier: i_purchaseorderpos_id
                                                                            - binary_operator: AND
                                                                            - column_reference:
                                                                              - naked_identifier: sop2popPurOrdPos
                                                                              - dot: .
                                                                              - naked_identifier: DT_DELETED
                                                                            - keyword: IS
                                                                            - null_literal: 'NULL'
                                                                      - join_clause:
                                                                        - keyword: INNER
                                                                        - keyword: JOIN
                                                                        - from_expression_element:
                                                                          - table_expression:
                                                                            - table_reference:
                                                                              - table_reference:
                                                                                - object_reference:
                                                                                  - naked_identifier: sao
                                                                                  - dot: .
                                                                                  - naked_identifier: PURORDER_p
                                                                          - alias_expression:
                                                                            - keyword: AS
                                                                            - naked_identifier: sop2popPurOrd
                                                                          - keyword: WITH
                                                                          - bracketed:
                                                                            - start_bracket: (
                                                                            - keyword: NOLOCK
                                                                            - end_bracket: )
                                                                        - join_on_condition:
                                                                          - keyword: ON
                                                                          - expression:
                                                                            - column_reference:
                                                                              - naked_identifier: sop2popPurOrd
                                                                              - dot: .
                                                                              - naked_identifier: I_PURORDER_P
                                                                            - comparison_operator:
                                                                              - raw_comparison_operator: =
                                                                            - column_reference:
                                                                              - naked_identifier: sop2popPurOrdPos
                                                                              - dot: .
                                                                              - naked_identifier: I_PURORDER_P
                                                                            - binary_operator: AND
                                                                            - column_reference:
                                                                              - naked_identifier: sop2popPurOrd
                                                                              - dot: .
                                                                              - naked_identifier: DT_DELETED
                                                                            - keyword: IS
                                                                            - null_literal: 'NULL'
                                                                      - join_clause:
                                                                        - keyword: LEFT
                                                                        - keyword: OUTER
                                                                        - keyword: JOIN
                                                                        - from_expression_element:
                                                                          - table_expression:
                                                                            - bracketed:
                                                                              - start_bracket: (
                                                                              - select_statement:
                                                                                - select_clause:
                                                                                  - keyword: SELECT
                                                                                  - select_clause_element:
                                                                                    - expression:
                                                                                      - column_reference:
                                                                                        - naked_identifier: Sop2PopId
                                                                                      - comparison_operator:
                                                                                        - raw_comparison_operator: =
                                                                                      - column_reference:
                                                                                        - naked_identifier: i_sop2pop_id
                                                                                  - comma: ','
                                                                                  - select_clause_element:
                                                                                    - expression:
                                                                                      - column_reference:
                                                                                        - naked_identifier: ItemQuantity
                                                                                      - comparison_operator:
                                                                                        - raw_comparison_operator: =
                                                                                      - function:
                                                                                        - function_name:
                                                                                          - function_name_identifier: SUM
                                                                                        - bracketed:
                                                                                          - start_bracket: (
                                                                                          - expression:
                                                                                            - column_reference:
                                                                                              - naked_identifier: i_itemquantity
                                                                                          - end_bracket: )
                                                                                - from_clause:
                                                                                  - keyword: FROM
                                                                                  - from_expression:
                                                                                    - from_expression_element:
                                                                                      - table_expression:
                                                                                        - table_reference:
                                                                                          - table_reference:
                                                                                            - object_reference:
                                                                                              - naked_identifier: sao
                                                                                              - dot: .
                                                                                              - naked_identifier: NegSoft_ERP_SalesOrderPosition2PurchaseOrderPositionLogistic
                                                                                      - keyword: WITH
                                                                                      - bracketed:
                                                                                        - start_bracket: (
                                                                                        - keyword: NOLOCK
                                                                                        - end_bracket: )
                                                                                - where_clause:
                                                                                  - keyword: WHERE
                                                                                  - expression:
                                                                                    - column_reference:
                                                                                      - naked_identifier: dt_deleted
                                                                                    - keyword: IS
                                                                                    - null_literal: 'NULL'
                                                                                - groupby_clause:
                                                                                  - keyword: GROUP
                                                                                  - keyword: BY
                                                                                  - column_reference:
                                                                                    - naked_identifier: i_sop2pop_id
                                                                              - end_bracket: )
                                                                          - alias_expression:
                                                                            - keyword: AS
                                                                            - naked_identifier: sop2popLogistic
                                                                        - join_on_condition:
                                                                          - keyword: ON
                                                                          - expression:
                                                                            - column_reference:
                                                                              - naked_identifier: sop2popLogistic
                                                                              - dot: .
                                                                              - naked_identifier: Sop2PopId
                                                                            - comparison_operator:
                                                                              - raw_comparison_operator: =
                                                                            - column_reference:
                                                                              - naked_identifier: SOP2POP
                                                                              - dot: .
                                                                              - naked_identifier: id
                                                                  - where_clause:
                                                                    - keyword: WHERE
                                                                    - expression:
                                                                      - column_reference:
                                                                        - naked_identifier: sop2pop
                                                                        - dot: .
                                                                        - naked_identifier: dt_deleted
                                                                      - keyword: IS
                                                                      - null_literal: 'NULL'
                                                                      - binary_operator: AND
                                                                      - column_reference:
                                                                        - naked_identifier: sop2popOrd
                                                                        - dot: .
                                                                        - naked_identifier: i_orders_p
                                                                      - comparison_operator:
                                                                        - raw_comparison_operator: =
                                                                      - column_reference:
                                                                        - naked_identifier: Orders
                                                                        - dot: .
                                                                        - naked_identifier: i_orders_p
                                                                      - binary_operator: AND
                                                                      - function:
                                                                        - function_name:
                                                                          - function_name_identifier: COALESCE
                                                                        - bracketed:
                                                                          - start_bracket: (
                                                                          - expression:
                                                                            - column_reference:
                                                                              - naked_identifier: sop2popLogistic
                                                                              - dot: .
                                                                              - naked_identifier: ItemQuantity
                                                                          - comma: ','
                                                                          - expression:
                                                                            - numeric_literal: '0'
                                                                          - end_bracket: )
                                                                      - comparison_operator:
                                                                        - raw_comparison_operator: <
                                                                      - column_reference:
                                                                        - naked_identifier: SOP2POP
                                                                        - dot: .
                                                                        - naked_identifier: f_quantity
                                                                      - binary_operator: AND
                                                                      - function:
                                                                        - function_name:
                                                                          - function_name_identifier: COALESCE
                                                                        - bracketed:
                                                                          - start_bracket: (
                                                                          - expression:
                                                                            - column_reference:
                                                                              - naked_identifier: sop2popPurOrdPos
                                                                              - dot: .
                                                                              - naked_identifier: N_ITEMSTOREDQUANT
                                                                          - comma: ','
                                                                          - expression:
                                                                            - numeric_literal: '0'
                                                                          - end_bracket: )
                                                                      - comparison_operator:
                                                                        - raw_comparison_operator: <
                                                                      - column_reference:
                                                                        - naked_identifier: sop2popPurOrdPos
                                                                        - dot: .
                                                                        - naked_identifier: N_ITEMQUANTITY
                                                                      - binary_operator: AND
                                                                      - column_reference:
                                                                        - naked_identifier: sop2popOrd
                                                                        - dot: .
                                                                        - naked_identifier: N_STATE
                                                                      - comparison_operator:
                                                                        - raw_comparison_operator: <
                                                                      - numeric_literal: '16384'
                                                              - end_bracket: )
                                                          - comma: ','
                                                          - expression:
                                                            - null_literal: 'NULL'
                                                          - comma: ','
                                                          - expression:
                                                            - case_expression:
                                                              - keyword: CASE
                                                              - when_clause:
                                                                - keyword: WHEN
                                                                - expression:
                                                                  - bracketed:
                                                                    - start_bracket: (
                                                                    - expression:
                                                                      - function:
                                                                        - function_name:
                                                                          - function_name_identifier: ISNULL
                                                                        - bracketed:
                                                                          - start_bracket: (
                                                                          - expression:
                                                                            - bracketed:
                                                                              - start_bracket: (
                                                                              - expression:
                                                                                - select_statement:
                                                                                  - select_clause:
                                                                                    - keyword: SELECT
                                                                                    - select_clause_element:
                                                                                      - function:
                                                                                        - function_name:
                                                                                          - function_name_identifier: SUM
                                                                                        - bracketed:
                                                                                          - start_bracket: (
                                                                                          - expression:
                                                                                            - column_reference:
                                                                                              - naked_identifier: SalesOrderPosition2PurchaseOrderPosition
                                                                                              - dot: .
                                                                                              - naked_identifier: f_quantity
                                                                                          - end_bracket: )
                                                                                  - from_clause:
                                                                                    - keyword: FROM
                                                                                    - from_expression:
                                                                                      - from_expression_element:
                                                                                        - table_expression:
                                                                                          - table_reference:
                                                                                            - table_reference:
                                                                                              - object_reference:
                                                                                                - naked_identifier: sao
                                                                                                - dot: .
                                                                                                - naked_identifier: NegSoft_ERP_SalesOrderPosition2PurchaseOrderPosition
                                                                                        - alias_expression:
                                                                                          - keyword: AS
                                                                                          - naked_identifier: SalesOrderPosition2PurchaseOrderPosition
                                                                                        - keyword: WITH
                                                                                        - bracketed:
                                                                                          - start_bracket: (
                                                                                          - keyword: NOLOCK
                                                                                          - end_bracket: )
                                                                                      - join_clause:
                                                                                        - keyword: INNER
                                                                                        - keyword: JOIN
                                                                                        - from_expression_element:
                                                                                          - table_expression:
                                                                                            - table_reference:
                                                                                              - table_reference:
                                                                                                - object_reference:
                                                                                                  - naked_identifier: sao
                                                                                                  - dot: .
                                                                                                  - naked_identifier: ORDERPOS_P
                                                                                          - alias_expression:
                                                                                            - keyword: AS
                                                                                            - naked_identifier: OrdPos
                                                                                          - keyword: WITH
                                                                                          - bracketed:
                                                                                            - start_bracket: (
                                                                                            - keyword: NOLOCK
                                                                                            - end_bracket: )
                                                                                        - join_on_condition:
                                                                                          - keyword: ON
                                                                                          - expression:
                                                                                            - column_reference:
                                                                                              - naked_identifier: OrdPos
                                                                                              - dot: .
                                                                                              - naked_identifier: I_ORDERPOS_P
                                                                                            - comparison_operator:
                                                                                              - raw_comparison_operator: =
                                                                                            - column_reference:
                                                                                              - naked_identifier: SalesOrderPosition2PurchaseOrderPosition
                                                                                              - dot: .
                                                                                              - naked_identifier: i_orderpos_id
                                                                                            - binary_operator: AND
                                                                                            - column_reference:
                                                                                              - naked_identifier: OrdPos
                                                                                              - dot: .
                                                                                              - naked_identifier: DT_DELETED
                                                                                            - keyword: IS
                                                                                            - null_literal: 'NULL'
                                                                                      - join_clause:
                                                                                        - keyword: LEFT
                                                                                        - keyword: OUTER
                                                                                        - keyword: JOIN
                                                                                        - from_expression_element:
                                                                                          - table_expression:
                                                                                            - table_reference:
                                                                                              - table_reference:
                                                                                                - object_reference:
                                                                                                  - naked_identifier: sao
                                                                                                  - dot: .
                                                                                                  - naked_identifier: PURORDPOS_P
                                                                                          - alias_expression:
                                                                                            - keyword: AS
                                                                                            - naked_identifier: PurchaseOrderPosition
                                                                                          - keyword: WITH
                                                                                          - bracketed:
                                                                                            - start_bracket: (
                                                                                            - keyword: NOLOCK
                                                                                            - end_bracket: )
                                                                                        - join_on_condition:
                                                                                          - keyword: ON
                                                                                          - expression:
                                                                                            - column_reference:
                                                                                              - naked_identifier: PurchaseOrderPosition
                                                                                              - dot: .
                                                                                              - naked_identifier: I_PURORDPOS_P
                                                                                            - comparison_operator:
                                                                                              - raw_comparison_operator: =
                                                                                            - column_reference:
                                                                                              - naked_identifier: SalesOrderPosition2PurchaseOrderPosition
                                                                                              - dot: .
                                                                                              - naked_identifier: i_purchaseorderpos_id
                                                                                      - join_clause:
                                                                                        - keyword: LEFT
                                                                                        - keyword: OUTER
                                                                                        - keyword: JOIN
                                                                                        - from_expression_element:
                                                                                          - table_expression:
                                                                                            - table_reference:
                                                                                              - table_reference:
                                                                                                - object_reference:
                                                                                                  - naked_identifier: sao
                                                                                                  - dot: .
                                                                                                  - naked_identifier: PURORDER_P
                                                                                          - alias_expression:
                                                                                            - keyword: AS
                                                                                            - naked_identifier: PurchaseOrder
                                                                                          - keyword: WITH
                                                                                          - bracketed:
                                                                                            - start_bracket: (
                                                                                            - keyword: NOLOCK
                                                                                            - end_bracket: )
                                                                                        - join_on_condition:
                                                                                          - keyword: ON
                                                                                          - expression:
                                                                                            - column_reference:
                                                                                              - naked_identifier: PurchaseOrder
                                                                                              - dot: .
                                                                                              - naked_identifier: I_PURORDER_P
                                                                                            - comparison_operator:
                                                                                              - raw_comparison_operator: =
                                                                                            - column_reference:
                                                                                              - naked_identifier: PurchaseOrderPosition
                                                                                              - dot: .
                                                                                              - naked_identifier: I_PURORDER_P
                                                                                      - join_clause:
                                                                                        - keyword: LEFT
                                                                                        - keyword: OUTER
                                                                                        - keyword: JOIN
                                                                                        - from_expression_element:
                                                                                          - table_expression:
                                                                                            - table_reference:
                                                                                              - table_reference:
                                                                                                - object_reference:
                                                                                                  - naked_identifier: sao
                                                                                                  - dot: .
                                                                                                  - naked_identifier: NegSoft_ERP_PurchaseOrder
                                                                                          - alias_expression:
                                                                                            - keyword: AS
                                                                                            - naked_identifier: NXPurchaseOrder
                                                                                          - keyword: WITH
                                                                                          - bracketed:
                                                                                            - start_bracket: (
                                                                                            - keyword: NOLOCK
                                                                                            - end_bracket: )
                                                                                        - join_on_condition:
                                                                                          - keyword: ON
                                                                                          - expression:
                                                                                            - column_reference:
                                                                                              - naked_identifier: NXPurchaseOrder
                                                                                              - dot: .
                                                                                              - naked_identifier: id
                                                                                            - comparison_operator:
                                                                                              - raw_comparison_operator: =
                                                                                            - column_reference:
                                                                                              - naked_identifier: PurchaseOrder
                                                                                              - dot: .
                                                                                              - naked_identifier: I_PURORDER_P
                                                                                  - where_clause:
                                                                                    - keyword: WHERE
                                                                                    - expression:
                                                                                      - column_reference:
                                                                                        - naked_identifier: OrdPos
                                                                                        - dot: .
                                                                                        - naked_identifier: I_ORDERS_P
                                                                                      - comparison_operator:
                                                                                        - raw_comparison_operator: =
                                                                                      - column_reference:
                                                                                        - naked_identifier: Orders
                                                                                        - dot: .
                                                                                        - naked_identifier: I_ORDERS_P
                                                                                      - binary_operator: AND
                                                                                      - column_reference:
                                                                                        - naked_identifier: SalesOrderPosition2PurchaseOrderPosition
                                                                                        - dot: .
                                                                                        - naked_identifier: dt_deleted
                                                                                      - keyword: IS
                                                                                      - null_literal: 'NULL'
                                                                                      - binary_operator: AND
                                                                                      - column_reference:
                                                                                        - naked_identifier: PurchaseOrderPosition
                                                                                        - dot: .
                                                                                        - naked_identifier: DT_DELETED
                                                                                      - keyword: IS
                                                                                      - null_literal: 'NULL'
                                                                                      - binary_operator: AND
                                                                                      - column_reference:
                                                                                        - naked_identifier: PurchaseOrder
                                                                                        - dot: .
                                                                                        - naked_identifier: B_CANCEL
                                                                                      - comparison_operator:
                                                                                        - raw_comparison_operator: =
                                                                                      - numeric_literal: '0'
                                                                                      - binary_operator: AND
                                                                                      - bracketed:
                                                                                        - start_bracket: (
                                                                                        - expression:
                                                                                          - column_reference:
                                                                                            - naked_identifier: PurchaseOrderPosition
                                                                                            - dot: .
                                                                                            - naked_identifier: N_ITEMSTOREDQUANT
                                                                                          - comparison_operator:
                                                                                            - raw_comparison_operator: '>'
                                                                                          - numeric_literal: '0'
                                                                                          - binary_operator: OR
                                                                                          - column_reference:
                                                                                            - naked_identifier: PurchaseOrder
                                                                                            - dot: .
                                                                                            - naked_identifier: N_STATE
                                                                                          - comparison_operator:
                                                                                            - raw_comparison_operator: <
                                                                                          - numeric_literal: '16384'
                                                                                        - end_bracket: )
                                                                                      - binary_operator: AND
                                                                                      - column_reference:
                                                                                        - naked_identifier: PurchaseOrder
                                                                                        - dot: .
                                                                                        - naked_identifier: DT_DELETED
                                                                                      - keyword: IS
                                                                                      - null_literal: 'NULL'
                                                                                      - binary_operator: AND
                                                                                      - column_reference:
                                                                                        - naked_identifier: NXPurchaseOrder
                                                                                        - dot: .
                                                                                        - naked_identifier: b_dropshipment
                                                                                      - comparison_operator:
                                                                                        - raw_comparison_operator: =
                                                                                      - numeric_literal: '1'
                                                                              - end_bracket: )
                                                                          - comma: ','
                                                                          - expression:
                                                                            - numeric_literal: '0'
                                                                          - end_bracket: )
                                                                    - end_bracket: )
                                                                  - comparison_operator:
                                                                    - raw_comparison_operator: '>'
                                                                  - numeric_literal: '0'
                                                                - keyword: THEN
                                                                - expression:
                                                                  - numeric_literal: '0'
                                                              - else_clause:
                                                                - keyword: ELSE
                                                                - expression:
                                                                  - numeric_literal: '2'
                                                              - keyword: END
                                                            - binary_operator: +
                                                            - bracketed:
                                                              - start_bracket: (
                                                              - expression:
                                                                - case_expression:
                                                                  - keyword: CASE
                                                                  - when_clause:
                                                                    - keyword: WHEN
                                                                    - expression:
                                                                      - bracketed:
                                                                        - start_bracket: (
                                                                        - expression:
                                                                          - bracketed:
                                                                            - start_bracket: (
                                                                            - expression:
                                                                              - select_statement:
                                                                                - select_clause:
                                                                                  - keyword: SELECT
                                                                                  - select_clause_element:
                                                                                    - function:
                                                                                      - function_name:
                                                                                        - function_name_identifier: COUNT
                                                                                      - bracketed:
                                                                                        - start_bracket: (
                                                                                        - star: '*'
                                                                                        - end_bracket: )
                                                                                - from_clause:
                                                                                  - keyword: FROM
                                                                                  - from_expression:
                                                                                    - from_expression_element:
                                                                                      - table_expression:
                                                                                        - table_reference:
                                                                                          - table_reference:
                                                                                            - object_reference:
                                                                                              - naked_identifier: sao
                                                                                              - dot: .
                                                                                              - naked_identifier: ORDERPOS_P
                                                                                      - alias_expression:
                                                                                        - keyword: AS
                                                                                        - naked_identifier: PositionMain
                                                                                      - keyword: WITH
                                                                                      - bracketed:
                                                                                        - start_bracket: (
                                                                                        - keyword: READUNCOMMITTED
                                                                                        - end_bracket: )
                                                                                    - join_clause:
                                                                                      - keyword: INNER
                                                                                      - keyword: JOIN
                                                                                      - from_expression_element:
                                                                                        - table_expression:
                                                                                          - table_reference:
                                                                                            - table_reference:
                                                                                              - object_reference:
                                                                                                - naked_identifier: sao
                                                                                                - dot: .
                                                                                                - naked_identifier: NegSoft_ERP_SalesOrderPosition
                                                                                        - alias_expression:
                                                                                          - keyword: AS
                                                                                          - naked_identifier: NxPositionReference
                                                                                        - keyword: WITH
                                                                                        - bracketed:
                                                                                          - start_bracket: (
                                                                                          - keyword: READUNCOMMITTED
                                                                                          - end_bracket: )
                                                                                      - join_on_condition:
                                                                                        - keyword: ON
                                                                                        - expression:
                                                                                          - column_reference:
                                                                                            - naked_identifier: NxPositionReference
                                                                                            - dot: .
                                                                                            - naked_identifier: i_installedintoposition_id
                                                                                          - comparison_operator:
                                                                                            - raw_comparison_operator: =
                                                                                          - column_reference:
                                                                                            - naked_identifier: PositionMain
                                                                                            - dot: .
                                                                                            - naked_identifier: I_ORDERPOS_P
                                                                                    - join_clause:
                                                                                      - keyword: INNER
                                                                                      - keyword: JOIN
                                                                                      - from_expression_element:
                                                                                        - table_expression:
                                                                                          - table_reference:
                                                                                            - table_reference:
                                                                                              - object_reference:
                                                                                                - naked_identifier: sao
                                                                                                - dot: .
                                                                                                - naked_identifier: ORDERPOS_P
                                                                                        - alias_expression:
                                                                                          - keyword: AS
                                                                                          - naked_identifier: PositionReference
                                                                                        - keyword: WITH
                                                                                        - bracketed:
                                                                                          - start_bracket: (
                                                                                          - keyword: READUNCOMMITTED
                                                                                          - end_bracket: )
                                                                                      - join_on_condition:
                                                                                        - keyword: ON
                                                                                        - expression:
                                                                                          - column_reference:
                                                                                            - naked_identifier: PositionReference
                                                                                            - dot: .
                                                                                            - naked_identifier: I_ORDERPOS_P
                                                                                          - comparison_operator:
                                                                                            - raw_comparison_operator: =
                                                                                          - column_reference:
                                                                                            - naked_identifier: NxPositionReference
                                                                                            - dot: .
                                                                                            - naked_identifier: id
                                                                                          - binary_operator: AND
                                                                                          - column_reference:
                                                                                            - naked_identifier: PositionReference
                                                                                            - dot: .
                                                                                            - naked_identifier: DT_DELETED
                                                                                          - keyword: IS
                                                                                          - null_literal: 'NULL'
                                                                                - where_clause:
                                                                                  - keyword: WHERE
                                                                                  - expression:
                                                                                    - column_reference:
                                                                                      - naked_identifier: PositionMain
                                                                                      - dot: .
                                                                                      - naked_identifier: DT_DELETED
                                                                                    - keyword: IS
                                                                                    - null_literal: 'NULL'
                                                                                    - binary_operator: AND
                                                                                    - column_reference:
                                                                                      - naked_identifier: PositionMain
                                                                                      - dot: .
                                                                                      - naked_identifier: I_ORDERS_P
                                                                                    - comparison_operator:
                                                                                      - raw_comparison_operator: =
                                                                                    - column_reference:
                                                                                      - naked_identifier: OrderPositions
                                                                                      - dot: .
                                                                                      - naked_identifier: I_ORDERS_P
                                                                                    - binary_operator: AND
                                                                                    - column_reference:
                                                                                      - naked_identifier: OrderPositions
                                                                                      - dot: .
                                                                                      - naked_identifier: I_ORDERPOS_P
                                                                                    - keyword: IN
                                                                                    - bracketed:
                                                                                      - start_bracket: (
                                                                                      - column_reference:
                                                                                        - naked_identifier: PositionMain
                                                                                        - dot: .
                                                                                        - naked_identifier: I_ORDERPOS_P
                                                                                      - comma: ','
                                                                                      - column_reference:
                                                                                        - naked_identifier: PositionReference
                                                                                        - dot: .
                                                                                        - naked_identifier: I_ORDERPOS_P
                                                                                      - end_bracket: )
                                                                            - end_bracket: )
                                                                          - binary_operator: +
                                                                          - bracketed:
                                                                            - start_bracket: (
                                                                            - expression:
                                                                              - select_statement:
                                                                                - select_clause:
                                                                                  - keyword: SELECT
                                                                                  - select_clause_element:
                                                                                    - function:
                                                                                      - function_name:
                                                                                        - function_name_identifier: COUNT
                                                                                      - bracketed:
                                                                                        - start_bracket: (
                                                                                        - star: '*'
                                                                                        - end_bracket: )
                                                                                - from_clause:
                                                                                  - keyword: FROM
                                                                                  - from_expression:
                                                                                    - from_expression_element:
                                                                                      - table_expression:
                                                                                        - table_reference:
                                                                                          - table_reference:
                                                                                            - object_reference:
                                                                                              - naked_identifier: sao
                                                                                              - dot: .
                                                                                              - naked_identifier: NegSoft_ERP_SalesOrderPositionReference
                                                                                      - alias_expression:
                                                                                        - keyword: AS
                                                                                        - naked_identifier: op2ref
                                                                                      - keyword: WITH
                                                                                      - bracketed:
                                                                                        - start_bracket: (
                                                                                        - keyword: NOLOCK
                                                                                        - end_bracket: )
                                                                                    - join_clause:
                                                                                      - keyword: INNER
                                                                                      - keyword: JOIN
                                                                                      - from_expression_element:
                                                                                        - table_expression:
                                                                                          - table_reference:
                                                                                            - table_reference:
                                                                                              - object_reference:
                                                                                                - naked_identifier: sao
                                                                                                - dot: .
                                                                                                - naked_identifier: ORDERPOS_P
                                                                                        - alias_expression:
                                                                                          - keyword: AS
                                                                                          - naked_identifier: Position
                                                                                        - keyword: WITH
                                                                                        - bracketed:
                                                                                          - start_bracket: (
                                                                                          - keyword: NOLOCK
                                                                                          - end_bracket: )
                                                                                      - join_on_condition:
                                                                                        - keyword: ON
                                                                                        - expression:
                                                                                          - column_reference:
                                                                                            - naked_identifier: Position
                                                                                            - dot: .
                                                                                            - naked_identifier: I_ORDERPOS_P
                                                                                          - comparison_operator:
                                                                                            - raw_comparison_operator: =
                                                                                          - column_reference:
                                                                                            - naked_identifier: op2ref
                                                                                            - dot: .
                                                                                            - naked_identifier: i_position_id
                                                                                          - binary_operator: AND
                                                                                          - column_reference:
                                                                                            - naked_identifier: Position
                                                                                            - dot: .
                                                                                            - naked_identifier: DT_DELETED
                                                                                          - keyword: IS
                                                                                          - null_literal: 'NULL'
                                                                                    - join_clause:
                                                                                      - keyword: INNER
                                                                                      - keyword: JOIN
                                                                                      - from_expression_element:
                                                                                        - table_expression:
                                                                                          - table_reference:
                                                                                            - table_reference:
                                                                                              - object_reference:
                                                                                                - naked_identifier: sao
                                                                                                - dot: .
                                                                                                - naked_identifier: ORDERPOS_P
                                                                                        - alias_expression:
                                                                                          - keyword: AS
                                                                                          - naked_identifier: PositionRef
                                                                                        - keyword: WITH
                                                                                        - bracketed:
                                                                                          - start_bracket: (
                                                                                          - keyword: NOLOCK
                                                                                          - end_bracket: )
                                                                                      - join_on_condition:
                                                                                        - keyword: ON
                                                                                        - expression:
                                                                                          - column_reference:
                                                                                            - naked_identifier: PositionRef
                                                                                            - dot: .
                                                                                            - naked_identifier: I_ORDERPOS_P
                                                                                          - comparison_operator:
                                                                                            - raw_comparison_operator: =
                                                                                          - column_reference:
                                                                                            - naked_identifier: op2ref
                                                                                            - dot: .
                                                                                            - naked_identifier: i_positionref_id
                                                                                          - binary_operator: AND
                                                                                          - column_reference:
                                                                                            - naked_identifier: PositionRef
                                                                                            - dot: .
                                                                                            - naked_identifier: DT_DELETED
                                                                                          - keyword: IS
                                                                                          - null_literal: 'NULL'
                                                                                - where_clause:
                                                                                  - keyword: WHERE
                                                                                  - expression:
                                                                                    - column_reference:
                                                                                      - naked_identifier: OrderPositions
                                                                                      - dot: .
                                                                                      - naked_identifier: I_ORDERPOS_P
                                                                                    - keyword: IN
                                                                                    - bracketed:
                                                                                      - start_bracket: (
                                                                                      - column_reference:
                                                                                        - naked_identifier: op2ref
                                                                                        - dot: .
                                                                                        - naked_identifier: i_position_id
                                                                                      - comma: ','
                                                                                      - column_reference:
                                                                                        - naked_identifier: op2ref
                                                                                        - dot: .
                                                                                        - naked_identifier: i_positionref_id
                                                                                      - end_bracket: )
                                                                                    - binary_operator: AND
                                                                                    - column_reference:
                                                                                      - naked_identifier: op2ref
                                                                                      - dot: .
                                                                                      - naked_identifier: i_referencetype_id
                                                                                    - comparison_operator:
                                                                                      - raw_comparison_operator: =
                                                                                    - numeric_literal: '1'
                                                                                    - binary_operator: AND
                                                                                    - column_reference:
                                                                                      - naked_identifier: OrderPositions
                                                                                      - dot: .
                                                                                      - naked_identifier: I_ORDERS_P
                                                                                    - comparison_operator:
                                                                                      - raw_comparison_operator: =
                                                                                    - column_reference:
                                                                                      - naked_identifier: Orders
                                                                                      - dot: .
                                                                                      - naked_identifier: I_ORDERS_P
                                                                                    - binary_operator: AND
                                                                                    - column_reference:
                                                                                      - naked_identifier: op2ref
                                                                                      - dot: .
                                                                                      - naked_identifier: dt_deleted
                                                                                    - keyword: IS
                                                                                    - null_literal: 'NULL'
                                                                            - end_bracket: )
                                                                          - comparison_operator:
                                                                            - raw_comparison_operator: '>'
                                                                          - numeric_literal: '0'
                                                                        - end_bracket: )
                                                                    - keyword: THEN
                                                                    - expression:
                                                                      - numeric_literal: '1'
                                                                  - else_clause:
                                                                    - keyword: ELSE
                                                                    - expression:
                                                                      - numeric_literal: '0'
                                                                  - keyword: END
                                                              - end_bracket: )
                                                            - binary_operator: +
                                                            - numeric_literal: '1'
                                                          - comma: ','
                                                          - expression:
                                                            - quoted_literal: '''BW'''
                                                          - end_bracket: )
                                          - end_bracket: )
                                      - comma: ','
                                      - expression:
                                        - column_reference:
                                          - naked_identifier: NxOrder
                                          - dot: .
                                          - naked_identifier: dt_deliverydate
                                      - end_bracket: )
                                  - comparison_operator:
                                    - raw_comparison_operator: <
                                  - numeric_literal: '0'
                            - end_bracket: )
                        - keyword: THEN
                        - expression:
                          - numeric_literal: '1'
                      - else_clause:
                        - keyword: ELSE
                        - expression:
                          - numeric_literal: '0'
                      - keyword: END
                  - end_bracket: )
          - from_clause:
            - keyword: FROM
            - from_expression:
              - from_expression_element:
                - table_expression:
                  - table_reference:
                    - table_reference:
                      - object_reference:
                        - naked_identifier: sao
                        - dot: .
                        - naked_identifier: ORDERS_P
                - alias_expression:
                  - keyword: AS
                  - naked_identifier: Orders
                - keyword: WITH
                - bracketed:
                  - start_bracket: (
                  - keyword: READUNCOMMITTED
                  - end_bracket: )
              - join_clause:
                - keyword: INNER
                - keyword: JOIN
                - from_expression_element:
                  - table_expression:
                    - table_reference:
                      - table_reference:
                        - object_reference:
                          - naked_identifier: sao
                          - dot: .
                          - naked_identifier: NegSoft_ERP_SalesOrder
                  - alias_expression:
                    - keyword: AS
                    - naked_identifier: NxOrder
                  - keyword: WITH
                  - bracketed:
                    - start_bracket: (
                    - keyword: READUNCOMMITTED
                    - end_bracket: )
                - join_on_condition:
                  - keyword: ON
                  - expression:
                    - column_reference:
                      - naked_identifier: NxOrder
                      - dot: .
                      - naked_identifier: id
                    - comparison_operator:
                      - raw_comparison_operator: =
                    - column_reference:
                      - naked_identifier: Orders
                      - dot: .
                      - naked_identifier: I_ORDERS_P
          - where_clause:
            - keyword: WHERE
            - expression:
              - column_reference:
                - naked_identifier: Orders
                - dot: .
                - naked_identifier: N_STATE
              - comparison_operator:
                - raw_comparison_operator: <
                - raw_comparison_operator: =
              - numeric_literal: '32'
              - binary_operator: AND
              - bracketed:
                - start_bracket: (
                - expression:
                  - column_reference:
                    - naked_identifier: NxOrder
                    - dot: .
                    - naked_identifier: i_deliverydatetype_id
                  - keyword: IN
                  - bracketed:
                    - start_bracket: (
                    - numeric_literal: '1'
                    - comma: ','
                    - numeric_literal: '2'
                    - end_bracket: )
                  - binary_operator: OR
                  - column_reference:
                    - naked_identifier: NxOrder
                    - dot: .
                    - naked_identifier: dt_communicateddeliverydate
                  - keyword: IS
                  - keyword: NOT
                  - null_literal: 'NULL'
                - end_bracket: )
              - binary_operator: AND
              - column_reference:
                - naked_identifier: Orders
                - dot: .
                - naked_identifier: DT_DELETED
              - keyword: IS
              - null_literal: 'NULL'
        - end_bracket: )
    - update_statement:
      - keyword: UPDATE
      - table_reference:
        - table_reference:
          - object_reference:
            - naked_identifier: NxOrder
      - set_clause_list:
        - keyword: SET
        - set_clause:
          - column_reference:
            - naked_identifier: b_deliverydatecritical
          - comparison_operator:
            - raw_comparison_operator: =
          - column_reference:
            - naked_identifier: OrderDeliverydateCriticalCTE
            - dot: .
            - naked_identifier: CalculatedState
      - from_clause:
        - keyword: FROM
        - from_expression:
          - from_expression_element:
            - table_expression:
              - table_reference:
                - table_reference:
                  - object_reference:
                    - naked_identifier: OrderDeliverydateCriticalCTE
          - join_clause:
            - keyword: INNER
            - keyword: JOIN
            - from_expression_element:
              - table_expression:
                - table_reference:
                  - table_reference:
                    - object_reference:
                      - naked_identifier: sao
                      - dot: .
                      - naked_identifier: NegSoft_ERP_SalesOrder
              - alias_expression:
                - keyword: AS
                - naked_identifier: NxOrder
              - keyword: WITH
              - bracketed:
                - start_bracket: (
                - keyword: READUNCOMMITTED
                - end_bracket: )
            - join_on_condition:
              - keyword: ON
              - expression:
                - column_reference:
                  - naked_identifier: NxOrder
                  - dot: .
                  - naked_identifier: id
                - comparison_operator:
                  - raw_comparison_operator: =
                - column_reference:
                  - naked_identifier: OrderDeliverydateCriticalCTE
                  - dot: .
                  - naked_identifier: OrderID
      - where_clause:
        - keyword: WHERE
        - expression:
          - column_reference:
            - naked_identifier: OrderDeliverydateCriticalCTE
            - dot: .
            - naked_identifier: CalculatedState
          - comparison_operator:
            - raw_comparison_operator: '!'
            - raw_comparison_operator: =
          - column_reference:
            - naked_identifier: OrderDeliverydateCriticalCTE
            - dot: .
            - naked_identifier: CurrentState
- statement_terminator: ;
